<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Assume we have three strata,   \(s_0\)  ,  \(s_1\)  , and  \(s_2\)  , where  \(s_0\)  is the &ldquo;reference&rdquo; stratum – in other words,  \(s_0\)  is the stratum for which the 0/1 indicator is 0 across the board in the indicator matrix below (the first row):
 \[\begin{bmatrix} 1 & 0 & 0 \\ 1 & 1 & 0 \\ 1 & 0 & 1 \end{bmatrix}\]  B_0 + (B_1 + B_1_s1_offset * s1 + B_1_s2_offset * s2) * x_1 # in stratum s0 B_0 + (B_1) * x_1 # in stratum s1 B_0 + (B_1 + B_1_s1_offset * s1) * x_1 # in stratum s2 B_0 + (B_1 + B_1_s2_offset * s2) * x_1 # lm(y~x1*x2) model.">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="Stratum-varying fixed effects">
<meta property="og:description" content="Assume we have three strata,   \(s_0\)  ,  \(s_1\)  , and  \(s_2\)  , where  \(s_0\)  is the &ldquo;reference&rdquo; stratum – in other words,  \(s_0\)  is the stratum for which the 0/1 indicator is 0 across the board in the indicator matrix below (the first row):
 \[\begin{bmatrix} 1 & 0 & 0 \\ 1 & 1 & 0 \\ 1 & 0 & 1 \end{bmatrix}\]  B_0 + (B_1 + B_1_s1_offset * s1 + B_1_s2_offset * s2) * x_1 # in stratum s0 B_0 + (B_1) * x_1 # in stratum s1 B_0 + (B_1 + B_1_s1_offset * s1) * x_1 # in stratum s2 B_0 + (B_1 + B_1_s2_offset * s2) * x_1 # lm(y~x1*x2) model.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://lzachmann.github.io/models-for-missing-data/posts/stratum-varying-fixed-effects/"><meta property="article:section" content="posts">
<meta property="article:modified_time" content="2022-01-11T10:26:51-07:00">
<title>Stratum-varying fixed effects | Models for missing data</title>
<link rel=manifest href=/models-for-missing-data/manifest.json>
<link rel=icon href=/models-for-missing-data/favicon.png type=image/x-icon>
<link rel=stylesheet href=/models-for-missing-data/book.min.89a77f7e702a8626749b948bbfb01109823daf6c1246ca407d1378833494c402.css integrity="sha256-iad/fnAqhiZ0m5SLv7ARCYI9r2wSRspAfRN4gzSUxAI=" crossorigin=anonymous>
<script defer src=/models-for-missing-data/flexsearch.min.js></script>
<script defer src=/models-for-missing-data/en.search.min.7edf370ce41df5472d9ea1909d7fe188b475558b70330aaa1b2cb9e2a9e0b95a.js integrity="sha256-ft83DOQd9UctnqGQnX/hiLR1VYtwMwqqGyy54qnguVo=" crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-W93Y6ZYE7X"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-W93Y6ZYE7X',{anonymize_ip:!1})}</script>
<link rel=stylesheet type=text/css href=/models-for-missing-data/hugo-cite.css>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/models-for-missing-data/><span>Models for missing data</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/>Guide</a>
<ul>
<li>
<input type=checkbox id=section-f7766582f62ab983cd62571b7c710fac class=toggle>
<label for=section-f7766582f62ab983cd62571b7c710fac class="flex justify-between">
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/>Analysis inputs</a>
</label>
<ul>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/sampling-design/>Sampling design</a>
</li>
<li>
<input type=checkbox id=section-35783569a5ce73f2b5c1ecc0d6500018 class=toggle>
<label for=section-35783569a5ce73f2b5c1ecc0d6500018 class="flex justify-between">
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/>Metadata syntax</a>
</label>
<ul>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/data-block/>Data Block</a>
<ul>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/data-block/response-info/>Response info</a>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/data-block/site-loc-info/>Site location</a>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/data-block/covariate-info/>Covariates</a>
</li>
</ul>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/model-block/>Model Block</a>
<ul>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/model-block/likelihood/>Likelihood</a>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/model-block/link/>Link function</a>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/metadata-syntax/model-block/group-level-effects/>Group-level effects</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/analysis-inputs/monitoring-data/>Monitoring data</a>
</li>
</ul>
</li>
<li>
<input type=checkbox id=section-d7373ca643fcc6c02c8442c160b52546 class=toggle>
<label for=section-d7373ca643fcc6c02c8442c160b52546 class="flex justify-between">
<a role=button>Model info</a>
</label>
<ul>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/model-info/data-types/>Data Types</a>
<ul>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/model-info/data-types/counts/>Counts</a>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/model-info/data-types/proportions/>Proportions</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<input type=checkbox id=section-3bbc37212c4a16cbcb354e76443d9d1c class=toggle>
<label for=section-3bbc37212c4a16cbcb354e76443d9d1c class="flex justify-between">
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/usage/>Usage</a>
</label>
<ul>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/usage/git/>Getting started</a>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/usage/gui/>Graphical user interface</a>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/usage/cli/>Command line interface</a>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/guide/usage/model-builder/>Model builder</a>
</li>
</ul>
</li>
</ul>
</li>
<li>
<a href=https://lzachmann.github.io/models-for-missing-data/docs/faq/>FAQ</a>
<ul>
</ul>
</li>
</ul>
<ul>
<li>
<a href=/models-for-missing-data/posts/>
Posts
</a>
</li>
<li>
<a href=https://github.com/lzachmann/models-for-missing-data target=_blank rel=noopener>
GitHub
</a>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/models-for-missing-data/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Stratum-varying fixed effects</strong>
<label for=toc-control>
<img src=/models-for-missing-data/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents></nav>
</aside>
</header>
<article class=markdown>
<h1>
<a href=/models-for-missing-data/posts/stratum-varying-fixed-effects/>Stratum-varying fixed effects</a>
</h1>
<div>
<a href=/models-for-missing-data/categories/background/>background</a>
</div>
<div>
<a href=/models-for-missing-data/tags/statistics/>statistics</a>,
<a href=/models-for-missing-data/tags/parameterizations/>parameterizations</a>
</div>
<p>Assume we have three strata,
<link rel=stylesheet href=/models-for-missing-data/katex/katex.min.css>
<script defer src=/models-for-missing-data/katex/katex.min.js></script>
<script defer src=/models-for-missing-data/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>
\(s_0\)
</span>
, <span>
\(s_1\)
</span>
, and <span>
\(s_2\)
</span>
, where <span>
\(s_0\)
</span>
is the &ldquo;reference&rdquo; stratum – in other words, <span>
\(s_0\)
</span>
is the stratum for which the 0/1 indicator is 0 across the board in the indicator matrix below (the first row):</p>
<span>
\[\begin{bmatrix}
1 & 0 & 0 \\
1 & 1 & 0 \\
1 & 0 & 1
\end{bmatrix}\]
</span>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R>B_0 <span style=color:#f92672>+</span> (B_1 <span style=color:#f92672>+</span> B_1_s1_offset <span style=color:#f92672>*</span> s1 <span style=color:#f92672>+</span> B_1_s2_offset <span style=color:#f92672>*</span> s2) <span style=color:#f92672>*</span> x_1  

<span style=color:#75715e># in stratum s0</span>
B_0 <span style=color:#f92672>+</span> (B_1) <span style=color:#f92672>*</span> x_1  

<span style=color:#75715e># in stratum s1</span>
B_0 <span style=color:#f92672>+</span> (B_1 <span style=color:#f92672>+</span> B_1_s1_offset <span style=color:#f92672>*</span> s1) <span style=color:#f92672>*</span> x_1  

<span style=color:#75715e># in stratum s2</span>
B_0 <span style=color:#f92672>+</span> (B_1 <span style=color:#f92672>+</span> B_1_s2_offset <span style=color:#f92672>*</span> s2) <span style=color:#f92672>*</span> x_1  

<span style=color:#75715e># lm(y~x1*x2)</span>
<span style=color:#a6e22e>model.matrix</span>(<span style=color:#f92672>~</span>x1<span style=color:#f92672>*</span>x2, <span style=color:#a6e22e>tibble</span>(x1 <span style=color:#f92672>=</span> <span style=color:#a6e22e>runif</span>(<span style=color:#ae81ff>5</span>), x2 <span style=color:#f92672>=</span> <span style=color:#a6e22e>runif</span>(<span style=color:#ae81ff>5</span>)))
</code></pre></div></article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
<div><a class="flex align-center" href=https://github.com/lzachmann/models-for-missing-data/commit/96cfc46b80081c24e23e7bad54c4b5920e814324 title="Last modified by Luke Zachmann | Jan 11, 2022" target=_blank rel=noopener>
<img src=/models-for-missing-data/svg/calendar.svg class=book-icon alt=Calendar>
<span>Jan 11, 2022</span>
</a>
</div>
<div>
<a class="flex align-center" href=https://github.com/lzachmann/models-for-missing-data/edit/main/docs/website/content/posts/stratum-varying-fixed-effects.md target=_blank rel=noopener>
<img src=/models-for-missing-data/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span>
</a>
</div>
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents></nav>
</div>
</aside>
</main>
</body>
</html>
name: "Model building composite run steps"
description: "Write model files using canned series of steps"
inputs:
  # workspace:
  #   description: "Working directory"
  #   required: true
  data-type:
    description: "Data type"
    required: true
  likelihood:
    description: "Probability distribution"
    required: true
  link:
    description: "Deterministic function for the mean"
    required: true
  gle:
    description: "Group-level effect(s)"
    required: true
    default: b0
runs:
  using: "composite"
  steps:
    - run: echo likelihood is ${{ inputs.likelihood }}
      shell: bash
    - run: echo link is ${{ inputs.link }}
      shell: bash
    - run: |
        cd model-api
        git checkout gh-submodule
        cat README.md
        cd ..
      shell: bash
    - run: |
        cd model-api
        ./src/model-builder/compile-jags-file.sh \
          ${{ inputs.likelihood }} ${{ inputs.link }} ${{ inputs.gle }} w1 \
          $MODEL_PATH
        cat $MODEL_PATH/crumbs.txt
        cat $MODEL_PATH/model.jags
      env:
        MODEL_PATH: ${{ github.workspace }}/${{ inputs.data-type }}/${{ inputs.likelihood }}-${{ inputs.link }}-${{ inputs.gle }}
      shell: bash
